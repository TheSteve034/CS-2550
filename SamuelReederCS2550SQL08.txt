--1
SELECT stu.FIRST_NAME, stu.LAST_NAME
FROM ENROLLMENT enr JOIN STUDENT stu ON enr.STUDENT_ID = stu.STUDENT_ID
WHERE enr.ENROLL_DATE= (SELECT MIN(ENROLL_DATE)
                        FROM ENROLLMENT);

--2
SELECT DESCRIPTION, SECTION_NO, COST, CAPACITY
FROM(SELECT cor.DESCRIPTION, sec.SECTION_NO, sec.CAPACITY, cor.COST
     FROM COURSE cor JOIN SECTION sec on cor.COURSE_NO = sec.COURSE_NO
     WHERE cor.COST = (SELECT MIN(COST) 
                       FROM COURSE))
WHERE CAPACITY <=(SELECT AVG(CAPACITY)
                  FROM SECTION);

--3
SELECT COURSE_NO, SUM(CAPACITY) AS "CAPACITY"
FROM SECTION
GROUP BY COURSE_NO
HAVING SUM(CAPACITY)<(SELECT AVG(CAPACITY)
                       FROM SECTION);

--4
SELECT STUDENT_ID, COUNT(*)
FROM ENROLLMENT
GROUP BY STUDENT_ID
HAVING COUNT(*) = (SELECT MAX(TOTAL)
                   FROM(SELECT COUNT(*) AS "TOTAL"
                   FROM ENROLLMENT 
                   GROUP BY STUDENT_ID));

--5
SELECT enr.STUDENT_ID, enr.SECTION_ID
FROM ENROLLMENT enr JOIN STUDENT stu ON enr.STUDENT_ID = stu.STUDENT_ID
WHERE stu.ZIP = 11365;

--6
SELECT cor.COURSE_NO, cor.DESCRIPTION
FROM COURSE cor 
JOIN SECTION sec 
ON cor.COURSE_NO = sec.COURSE_NO
JOIN INSTRUCTOR inst
ON sec.INSTRUCTOR_ID = inst.INSTRUCTOR_ID
WHERE inst.FIRST_NAME = 'Nina' AND inst.LAST_NAME = 'Schorin';

--7
SELECT FIRST_NAME, LAST_NAME
FROM STUDENT
WHERE STUDENT_ID NOT IN(SELECT STUDENT_ID
                            FROM ENROLLMENT);

--8
SELECT DISTINCT stu.FIRST_NAME, stu.LAST_NAME, cor.DESCRIPTION, sec.SECTION_ID
FROM GRADE g JOIN ENROLLMENT enr 
ON g.STUDENT_ID = enr.STUDENT_ID AND g.SECTION_ID = enr.SECTION_ID
JOIN STUDENT stu 
ON stu.STUDENT_ID = enr.STUDENT_ID
JOIN SECTION sec
ON sec.SECTION_ID = enr.SECTION_ID
JOIN COURSE cor 
ON cor.COURSE_NO = sec.COURSE_NO
WHERE g.NUMERIC_GRADE =(SELECT MIN(NUMERIC_GRADE)
                        FROM GRADE
                        WHERE GRADE_TYPE_CODE = 'PA') 
AND g.GRADE_TYPE_CODE = 'PA';

