--5
SELECT GRADE_TYPE_CODE, NUMERIC_GRADE AS "GRADE"
FROM GRADE
WHERE STUDENT_ID = 112 AND SECTION_ID = 95
UNION ALL
SELECT (SELECT 'Average for student 112' AS "caption" FROM DUAL), AVG
FROM
(SELECT ROUND(AVG(NUMERIC_GRADE),2) AS "AVG"
FROM GRADE
WHERE STUDENT_ID = 112 AND SECTION_ID = 95)
ORDER BY GRADE_TYPE_CODE DESC;

--6
SELECT t2.FIRST_NAME, t2.LAST_NAME, NVL(t1.SECTIONS, 0)
FROM
(SELECT COUNT(*) AS "SECTIONS", INSTRUCTOR_ID
FROM SECTION
GROUP BY INSTRUCTOR_ID) t1
RIGHT OUTER JOIN
(SELECT FIRST_NAME, LAST_NAME, INSTRUCTOR_ID
FROM INSTRUCTOR) t2
ON t1.INSTRUCTOR_ID = t2.INSTRUCTOR_ID
ORDER BY t2.LAST_NAME;

--7
SELECT t1.COURSE_NO, cor.DESCRIPTION
FROM
(
SELECT COURSE_NO, COUNT(*)
FROM
(
SELECT DISTINCT COURSE_NO, grade_type_code
FROM
(
SELECT DISTINCT sec.COURSE_NO, t1.SECTION_ID, t1.GRADE_TYPE_CODE
FROM
(
SELECT SECTION_ID, GRADE_TYPE_CODE
FROM GRADE
) t1 
JOIN SECTION sec 
ON t1.SECTION_ID = sec.SEcTION_ID
)
)
HAVING COUNT(*) = 6
GROUP BY COURSE_NO
) t1 JOIN COURSE cor
ON t1.COURSE_NO = cor.COURSE_NO
ORDER BY COURSE_NO;

--8
SELECT DISTINCT z.ZIP, z.CITY, CASE WHEN enr.STUDENT_ID IS NOT NULL THEN 1 ELSE 0 END AS "STUDENTS"
FROM ENROLLMENT enr JOIN STUDENT stu 
ON enr.STUDENT_ID = stu.STUDENT_ID
RIGHT OUTER JOIN ZIPCODE z
ON stu.ZIP = z.ZIP
WHERE z.CITY = 'Stamford'
ORDER BY z.ZIP;

--9
SELECT cor.COURSE_NO, cor.DESCRIPTION, NVL(NumStudents, 0) AS "ENROLLMENTS"
FROM 
(SELECT course_no, description
FROM COURSE cor
WHERE cor.DESCRIPTION LIKE '%Programming%') cor
LEFT OUTER JOIN 
(SELECT course_no, COUNT(*) AS NumStudents
FROM ENROLLMENT enr JOIN SECTION sec
ON enr.SECTION_ID = sec.SECTION_ID
GROUP BY course_no) stu
ON cor.COURSE_NO = stu.COURSE_NO
ORDER BY "ENROLLMENTS" DESC;

--10
SELECT stu.FIRST_NAME, stu.LAST_NAME, SUM(CASE WHEN enr.STUDENT_ID IS NOT NULL THEN 1 ELSE 0 END)
FROM ENROLLMENT enr RIGHT OUTER JOIN STUDENT stu
ON enr.STUDENT_ID = stu.STUDENT_ID
WHERE stu.PHONE like '617%'
GROUP BY stu.FIRST_NAME, stu.LAST_NAME, enr.STUDENT_ID
ORDER BY stu.LAST_NAME, stu.FIRST_NAME;
